# Bypassing Powershell Security

#### Invisi-Shell

Hooks .NET assemblies System.Management.Automation.dll & System.Core.dll to bypass logging.\
Utilises a CLR Profiler API to perform hooks.

{% embed url="https://github.com/OmerYa/Invisi-Shell/" %}

```
## With Admin Privs (modifies HKLM)
C:\> RunWithPathAsAdmin.bat

## Without Admin Privs (modifies HKCU)
C:\> RunWithRegistryNonAdmin.bat

## Type exit to leave the session and clean-up
```

#### Bypass AV Signatures - AMSI

* In-Memory scripts will bypass AMSI
* On-Disk scripts will need to utilise AMSITrigger to identify the section of script that would be detected, then make minor changes to the script to avoid detection

{% embed url="https://github.com/RythmStick/AMSITrigger/" %}

```
PS C:\> AmsiTrigger_x64.exe -i C:\Temp\somefile.ps1
```

* Fully obfuscate the Powershell script using Invoke-Obfuscation

{% embed url="https://github.com/danielbohannon/Invoke-Obfuscation/" %}
