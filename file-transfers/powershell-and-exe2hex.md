# Powershell & exe2hex

This method involves creating a Windows executable on the attacker machine, then converting the exe to a hexadecimal string and embedding the hex string into a script.

#### Compressing an Executable

Compressing the executable prior to converting to hex will save some space. The application upx on kali will help here. UPX is an "Executable Packer" or "PE Compression Tool".

```
kali@kali:~$ upx -9 file.exe
```

#### Converting the Executable

Utilising exe2hex to convert the binary executable into hexadecimal with .cmd extension as a Windows script that when run will use Powershell command-lets to rebuild the binary .exe file.&#x20;

```
kali@kali:~$ exe2hex -x file.exe -p file.cmd
```

#### Restoring the Executable

Once output the script can be copied and pasted to a shell on the Target machine and run. The main command contained at the end of the script to rebuild the executable is below. Once run the .exe will be runable on the Target machine.

```
C:\Temp>powershell -Command "$h=Get-Content -readcount 0 -path './file.hex';$l=$h[0].length;$b=New-Object byte[] ($l/2);$x=0;for ($i=0;$i -le $l-1;$i+=2){$b[$x]=[byte]::Parse($h[0].Substring($i,2),[System.Globalization.NumberStyles]::HexNumber);$x+=1};set-content -encoding byte 'file.exe' -value $b;Remove-Item -force file.hex;"
```

