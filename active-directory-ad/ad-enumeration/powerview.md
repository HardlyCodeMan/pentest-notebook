# PowerView

#### Quick Reference Commands (non-privileged)

* Get-Domain
* Get-Domain -Domain PlanetExpress.local
* Get-DomainSID
* Get-DomainPolicyData
* (Get-DomainPolicyData).KerberosPolicy
* Get-DomainController
* Get-DomainUser
* Get-DomainUser -Identity pjfry
* Get-DomainUser -Properties samaccountname,logonCount
* Get-DomainUser -LDAPFilter "Description=\*built\*" | Select name,Description
* Get-DomainComputer -Properties cn,logonCount
* Get-DomainComputer -LDAPFIlter "OperatingSystem=\*Server 2016\*" | select name,OperatingSystem
* Get-DomainGroup&#x20;
* Get-DomainGroup \*admin\* | select name
* Get-DomainGroup \*admin_\*_ -Domain PlanetExpress.local | select name,objectsid
* Get-DomainGroupMember -Identity "Domain Admins" -Recurse
* Get-DomainGroup -Username "pjfry"
* Invoke-ShareFinder -Verbose (noisy)
* Invoke-FileFinder -Verbose (noisy)
* Get-DomainGPO | select displayname
* Get-DomainGPOLocalGroup
* Get-DomainGPOComputerLocalGroupMapping -ComputerIdentity PlanetExpressShip
* Get-DomainGPOUserLocalGroupMapping -Identity pjfry -Verbose
* Get-DomainOU | select name,gplink
* Get-DomainGPO -Identity "{\<OU glplink>}"
* (Get-DomainOU -Identity \<Computer OU>).distinguishedname | %{Get-DomainComputer -SearchBase $\_} | select name
* Get-DomainObjectAcl -SamAccountName pfry -R esolveGUIDs
* Get-DomainObjectAcl -SearchBase "LDAP://CN=Domain Admins,CN=Users,DC=PlanetExpress,DC=local" -ResolveGUIDs -Verbose
* (Get-Acl "AD:\CN=Administrator,CN=Users,DC=PlanetExpress,DC=moneycorp,DC=local").Access \
  \### Requires the AD Module ###
* Find-InterestingDomainAcl -ResolveGUIDs
* Find-InterestingDomainAcl -ResolveGUIDs | select IdentityReferenceName,ActiveDirectoryRights
* Find-InterestingDomainAcl -ResolveGUIDs | ?{$\_.IdentityReferenceName -match "pfry"} | select IdentityReferenceName,ActiveDirectoryRights
* Get-PathAcl -Path "\\\dc.planetexpress.local\sysvol"
* Get-DomainTrust
* Get-DomainTrust –Domain planetexpress.local
* Get-Forest
* Get-Forest –Forest planetexpress.local
* Get-ForestDomain
* Get-ForestDomain –Forest planetexpress.local
* Get-ForestGlobalCatalog
* Get-ForestGlobalCatalog –Forest planetexpress.local
* Get-ForestTrust
* Get-ForestTrust –Forest planetexpress.local



#### Quick Reference Commands (privileged)

* Get-NetLocalGroup -ComputerName dc -ListGroups
* Get-NetLocalGroup -ComputerName dc -Recurse
* Get-NetLocalGroupmember -ComputerName dc -GroupName Administrators
* Get-NetLoggedon -ComputerName \<servername>
* Get-LoggedonLocal -ComputerName dc
* Get-LastLoggedOn -ComputerName \<servername>

